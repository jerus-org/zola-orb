description: >
  Build public site using zola.

executor:
  name: zola
  zola_version: <<parameters.zola_version>>

parameters:
  zola_version:
    type: string
    description: "The of zola to use"
  update_submodules:
    type: boolean
    default: true
    description: "If true, the git submodules will be updated."

steps:
  - checkout

  - when:
      condition: << parameters.update_submodules >>
      steps:
        - run:
          name: Sync git submodules
          command: |
            git submodule sync

        - run:
          name: Update git submodules
          command: |
            git submodule update --init

  - run:
    name: Confirm zola version
    command: |
      zola --version

  - run:
    name: Build site
    command: |
      zola build
